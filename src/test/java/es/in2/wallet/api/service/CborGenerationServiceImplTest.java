package es.in2.wallet.api.service;

import es.in2.wallet.api.service.impl.CborGenerationServiceImpl;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.junit.jupiter.MockitoExtension;
import reactor.test.StepVerifier;

import java.text.ParseException;
import java.util.Objects;

@ExtendWith(MockitoExtension.class)
class CborGenerationServiceImplTest {

    @InjectMocks
    private CborGenerationServiceImpl cborGenerationService;

    @Test
    void generateCborTest() throws ParseException {
        String processId = "123";
        String content = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2cCI6eyJpZCI6InVybjp1dWlkOjczMTdhMWI5LTVjYWEtNDE2ZC04YTMwLTM3MzllZmQyZWNiZiIsInR5cGUiOlsiVmVyaWZpYWJsZVByZXNlbnRhdGlvbiJdLCJob2xkZXIiOiJkaWQ6a2V5OnpEbmFlaXVjYURkUXJKVG5DSzcyekFSbnNNQ3NtN0V2YXE2Y29VZjJwUms5dWQ1UXQiLCJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvMjAxOC9jcmVkZW50aWFscy92MSJdLCJ2ZXJpZmlhYmxlQ3JlZGVudGlhbCI6WyI2QkZNK0tHWjlPSjIkUjJIMzhWL01SOjJSS0I1JEcvK1FGKlRETUlDUUtVK08tRzMkUFFPODEwUVUqLlRETzlKU1RMMjcxN1FOQVEtWk04Lk5OVjdXQzglS0ExJDJWWU4lKkJIVEY0LTNBQksvJFE4OTJSRzVHS1VORDhXSVNMN0JRR0tEIE9KLU5IQ1UlOVNIQ1VZWVVaUE4vM05ZUkQ3T1ZHTjhPUEE5N0xENUM2WFE5L1VHV0JNOU0vJEVLM09COEVJSUZOTlBLJDFOIEUlM05KRzNTMUdZOEYkN0NXNVVNVEZLJTNFMUUgIE1XSlUyWUhCLk0zJUNVRFZCVTdBNkRQUU9YV1UvNktHVDVXM1VVNzZMN0JNVVBCL01YWTVVNkI3REUlWjZYMElWMlY6MTNaJVZNJUdHLzk1QzBaMlFTTFRJN0wyQTAxSlA1VzcxTk1XUjFGOTAlVU1HKjMlNUI2NzVaOUNQSDJBLktXVEckMzZNNlREN1cxJU44OkNJIERHQktNRDkrWEZQNDRaTklGNDJBR01VSzEkUVBYK0xZNERIVlYlVkUuRjNMLUhYSUxKT0tQV0lSOTJLS0dRSjU1QkwvSlFXUkk0R0haLUlVUjFGVFUxSlJNVjVOU0gtRkFKWTVKMFY0S0dLK1VVQk8qVkRZQTg4MVYyU1NQK1YwRFFJRjczQUZFSDlCR1IgM0guM1daOThWTFFHNFVHRVNIRjQtOjNWLUE3WFI5Ukk1VzVVIDZKTDgtMU5NQkpHUVBSS0gtNE5PVjVVSUpFIE9NNVRSIEIlJFFELzRSU0NCWUFHSDguMDRYRzguU0JFSElKTTRWWTU5VVFUQUQtT0tUNklELjFNRjlKM0I5S0srQkpGMVBWSEVJTTNKRExMWkMkLTk5VURHKkpPMjAuMDE5KzAtNzVBKjkzREFPSkpBWDJIVjFCMzJMVU0xV0lHJEpRJExIVEgqQk9WTEtIKjRDSUw4UkhLJTVSWUxJODgvJEJET0pSSkg4NDYuSEUuOVQqNzYxNEYzNDIlL1ROT0hORU00UkFaQ09DRUlSOUk5UzJYR1RQUDRXQTk4TTYqOk8vN1ArTERCWjNJRE0zWEJCNTY4MlU1VlVHVjFBJVZJTzVXIDRJOVc0OjFZSEpZM0xXVUQxVFQ0REpRMEktJFJGKjE6TjctKjFYUTc4OU9ERlUtSDgqUFZLT1NVVFIwWFFUNEJTN05GRlZFUjk6OlVDKlIxMldOQ1FaLVIxLzUgOVFOR1U5L0sqME9SM04kOUIvWko1R0gvN1ZXRTc4TTAqS1EqNCJdfSwiZXhwIjoxNzA4NzUwNjE2LCJpYXQiOjE3MDg2OTA2MTYsImlzcyI6ImRpZDprZXk6ekRuYWVpdWNhRGRRckpUbkNLNzJ6QVJuc01Dc203RXZhcTZjb1VmMnBSazl1ZDVRdCIsImp0aSI6InVybjp1dWlkOjczMTdhMWI5LTVjYWEtNDE2ZC04YTMwLTM3MzllZmQyZWNiZiIsIm5iZiI6MTcwODY5MDYxNiwic3ViIjoiZGlkOmtleTp6RG5hZWl1Y2FEZFFySlRuQ0s3MnpBUm5zTUNzbTdFdmFxNmNvVWYycFJrOXVkNVF0Iiwibm9uY2UiOiJ1cm46dXVpZDplMDhkYjc0MC1jZWEyLTRmOTItYTNmYi0yN2E3YWEzOTQ0ZmIifQ.6kZYJWIrehJju3Ip8sS8uAshU_EBPAkoBglAyGcK6z4";

        StepVerifier.create(cborGenerationService.generateCbor(processId, content))
                .expectNextMatches(Objects::nonNull)
                .verifyComplete();
    }

}
